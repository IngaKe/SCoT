<!DOCTYPE html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

	<title>SCoT - Sense Clustering over Time</title>

	<!-- D3 and vue.js -->
	<script src="https://d3js.org/d3.v5.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

	<script type="text/javascript" src="%% url_for('static', filename='render_sense_graph.js') %%"></script>
	<script type="text/javascript" src="%% url_for('static', filename='render_graph_from_file.js') %%"></script>

	 <!-- Stylesheets -->
	<link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"/>
	<link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"/>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous"/>
	<link rel= "stylesheet" type= "text/css" href="%% url_for('static', filename='style.css') %%"/>

	<!-- Bootstrap Vue -->
	<script src="https://unpkg.com/vue"></script>
	<script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
</head>

<body>
<div id="vue-app">
<b-container id="body-container" class="body" fluid>
	<b-navbar type="dark" variant="dark" class="">
		<b-navbar-brand tag="h1" class="header">SCoT senseviewer</b-navbar-brand>
		<b-navbar-nav class="ml-auto">
		<b-nav-form>
			<b-button v-if="graph_rendered" id="recluster_button" v-on:click="recluster()"> Recluster</b-button>
			<b-button v-if="graph_rendered" id="edit_mask_button" v-on:click="showEditMask()">Edit Graph</b-button>
			<b-button v-if="graph_rendered" id="reset_zoom_button" v-on:click="resetZoom()">Reset Zoom</b-button>
		</b-nav-form>
		<b-nav-form>
			<b-button id="download_button" variant="success" v-on:click="saveGraph()" download="graph.json" href="">Save Graph</b-button>
			<b-button id="load_button" variant="danger" v-on:click="displayForm()">Load Graph</b-button>
		</b-nav-form>
	</b-navbar-nav>
	</b-navbar>

  <b-row id="rows">
    <b-col id="input-options" class="input_options" sm="2">

    	<b-form-group class="input" label="Enter target word">  
			<b-form-input v-model="target_word" placeholder="target word" size="sm"></b-form-input>
		</b-form-group>

		<b-form-group class="input" label="Number of neighbours">  
			<b-form-input type="number" v-model="senses" min="0" placeholder="number of senses" size="sm"></b-form-input>
		</b-form-group>

		<b-form-group class="input" label="Max. number of edges per node">  
			<b-form-input type="number" v-model="edges" min="0" placeholder="number of edges" size="sm"></b-form-input>
		</b-form-group>

		<b-form-group class="input" label="Mode">
		    <b-form-radio v-model="time_diff" name="time_diff" v-bind:value="false"> sense clustering (CW) </b-form-radio>
		    <b-form-radio v-model="time_diff" name="time_diff" v-bind:value="true">time diff</b-form-radio>
    	</b-form-group>

    	<b-form-group class="input" label="Select a start year">
			<b-form-select v-model="start_year" :options="start_years" size="sm"></b-form-select>
		</b-from-group>

		<b-form-group class="input" label="Select an end year">
			<b-form-select v-model="end_year" :options="end_years" size="sm"></b-form-select>
		</b-from-group>

		<b-form-group id="sticky" class="input" label="Dragging">
		    <b-form-radio name="sticky_mode" value="false"> Enable brush and single node movement </b-form-radio>
		    <b-form-radio name="sticky_mode" value="true"> Keep force for dragging (no brush available) </b-form-radio>
    	</b-form-group>

    	<b-form-group label="Charge strength">
    		<b-form-input id="range_charge" v-model="charge" type="range" min="-500" max="0"></b-form-input>
    	</b-form-group>

    	<b-form-group label="Link Distance">
    		<b-form-input id="range_linkdistance" v-model="linkdistance" type="range" min="0" max="1000"></b-form-input>
    	</b-form-group>

    	<b-button id="render_button" v-on:click="render_graph()">Render Graph</b-button>


    </b-col>

    <b-col id="graph_display" sm="7">
    	<div id="graph2"></div>
    </b-col>

    <b-col id="graph_params" sm="2">

    	<b-card v-if="graph_rendered" class="edit_clusters_card" id="edit_clusters_popup" header="Edit cluster settings" footer-tag="footer"> 

    		<b-card-text class="edit_cluster_textbox">
    			<b-list-group v-for="(cluster, index) in clusters" :key="index">
					<b-list-group-item class="list-item">
						<div class="overflow">
							<div class="clustername">
								<span class="dot" v-bind:style="{ 'background-color': cluster.colour }"></span>
								Cluster: <span class="bigger_font">{{ cluster.cluster_name }} </span>
							</div>
							<b-button v-b-toggle="'collapse-edit-' + index" id="edit_button" class="edit_button"> Edit </b-button>
								<b-collapse :id="'collapse-edit-' + index" class="mt-2"  aria-expanded="false">
									<b-card class="input_cluster">
									<b-form-group label="cluster name"> 
										<b-form-input v-model="cluster.cluster_name" size="sm"></b-form-input>
									</b-form-group>
									<b-form-group>
										<b-form-checkbox
									      id="checkbox_cluster_node"
									      v-model="cluster.cluster_node"
									      value="true"
									      unchecked-value="false"
									    >
									      Add cluster label to graph
									    </b-form-checkbox>
									</b-form-group>
									<b-form-group label="Select cluster colour">
										<b-form-input class="color-select" v-model="cluster.colour" type="color" :value="cluster.colour"> </b-form-input>
									</b-form-group>
									</b-card>
								</b-collapse>
							
							
								<b-button v-b-toggle="'collapse-nodes-' + index" id="accordion"> Nodes
									<span class="when-opened"><i class="fa fa-chevron-down" aria-hidden="true"></i></span>
	      							<span class="when-closed"><i class="fa fa-chevron-up" aria-hidden="true"></i></span>
								</b-button>
								<b-collapse :id="'collapse-nodes-' + index" class="mt-2">
									<b-card class="input_cluster">
									<p v-for="label in cluster.labels"> {{ label }}</p>
									</b-card>
								</b-collapse>

						</div>

					</b-list-group>
    			</b-list-group>
    		</b-card-text>
    		<div>
    		<b-button class="close_button" v-on:click="applyClusterSettings()">Apply</b-button>
    		<b-button class="close_button" variant="danger" v-on:click="closeForm('edit_clusters_popup')">Close</b-button>
    		</div>
    	</b-card>

    	<b-card class="form-popup" id="loadpopup">
			<b-card-text> Select a .json file to render graph from</b-card-text>
			<b-form-file id="file_input" v-model="file" :state="Boolean(file)" placeholder="Choose a file..." drop-placeholder="Drop file here..."> </b-form-file>
			<b-button id="render_file_button" href="#" variant="success" v-on:click="loadGraph()">Render</b-button>
		    <b-button id="cancel_button" href="#" variant="danger" v-on:click="closeForm('loadpopup')">Close</b-button>
		</b-card>
    
    </b-col>
  </b-row>
</b-container> 
</div>
<script src="static/vue.js"></script>
</body>

</html>